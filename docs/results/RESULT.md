# Целевая платформа

Mobile (Android/iOS)/macos/web

# Результаты

1. Релизована страница с магическим шаром
2. Реализовано взаимодействие с mock данными
3. Добавлена работа с сетью и обработка состояний ответов
4. Реализованы запросы по нажатию на шар и при тряске экрана + добавлена вибрация
5. Добавлена анимация движения шара и затемнение фона шара
6. Добавлена возможность смена цветовой схемы со сменой цвета шара

# Ссылки на демонстрацию работы/скриншоты

## Реализация

### Добавление assets

Картины художника начинаются с первого мазка, а проект на Flutter с добавления asset'ов (ИМХО) :)

<p align="center"><img src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/08f7ff1e-785c-4b99-b7a0-4fd10fcf9e9d" width="250"></p>

Проект небольшой, поэтому возможно, стоило прописать пути к этим нескольким файлам ручками, но мы же нацелены на рост любого проекта? Да и зачем чтото писать руками если есть автогенераторы. Тем более что после генерации создается класс с полями содержащими наши картинки. Удобно? Удобно.

<p align="center"><img width="230" alt="Снимок экрана 2023-07-26 в 09 49 55" src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/d9bd1398-a1e0-4d8b-9947-45e0eca408cb" width="250">
<img width="297" alt="Снимок экрана 2023-07-26 в 09 50 49" src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/531ac1e8-0570-4087-8d59-e67035e1b81f">
</p>

### Структура папок

Несмотря на то что заполнение многих папок происходило много позже, но в начале  создаем структуру папок, подготавливаем каркас.
<p align="center"><img width="345" alt="Снимок экрана 2023-07-26 в 09 52 20" src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/344a47bb-ff84-40be-81ec-5c2605e6ef6d"></p>
Из интересного можно отметить, что это некое подобие чистой архитектуры, её имплементация вдохновленная так называемой

["Riverpod Architecture"](https://codewithandrea.com/articles/flutter-app-architecture-riverpod-introduction/). Также имеем слои для данных, для визуала и domain слой содержащай наши модельки.

### Работа с данными

Для начала создаем модель для получения ответа с сервера, опять же можно было не использовать автогенерацию, но для перспективы проекта, да и просто для личного удобства, генерируем необходимые методы ;) 

<p align="center"><img width="503" alt="Снимок экрана 2023-07-26 в 09 56 01" src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/0870883e-1ebd-4e13-9d4f-c84a7731e0e2"></p>

После чего создаем фейковый репозиторий
<p align="center"><img width="596" alt="Снимок экрана 2023-07-26 в 09 57 07" src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/3023afc8-2667-47f6-95f9-41203e623e3f"></p>
Также не забываем про абстрактный класс, он у нас послужит неким контрактом при смене на репозиторий с реальными данными. Контракт поможет не ошибится в необходимых методах реализации.

Приведем сразу то, как реализовано получение данных с api и реальный репозиторий, чтобы не распылятся. 
<p align="center"><img width="541" alt="Снимок экрана 2023-07-26 в 10 52 42" src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/9fa61b18-9da8-4dcb-898d-9993e89b6f56">
<img width="616" alt="Снимок экрана 2023-07-26 в 10 52 54" src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/5a0a86f2-26e5-4e7f-b241-9135243f4e6e"></p>
Для создания взаимодействия с сетью используем пакет Retrofit, опять же автогенерируем для него необходимые файлы, перед этим потратив совсем немного времени на объявления используемых api.

### Виджет шара

Сам виджет представляет из себя несколько наслоенных через Stack картинок (чтобы когда нибудь "оживить" движение звезд). За смену состояний отвечает AsyncNotifierProvider (из пакета Riverpod), за которым мы наблюдаем и в зависимости от состояния переменной отображаем необходимые виджеты. А благодаря AnimatedSwitcher происходит плавное затемнение при их смене.
<p align="center"><img width="511" alt="Снимок экрана 2023-07-26 в 09 53 36" src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/0f8a4980-1746-4e5e-93ab-2b351be17a0f"></p>

### Анимация плавного движения

Для добавления анимации создаем отдельный провайдер для хранения контроллера анимации:
<p align="center"><img width="520" alt="Снимок экрана 2023-07-26 в 10 05 42" src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/cb8c8708-1ff5-42e3-b9af-d6b6535b83fa"></p>
После чего используем его в AnimetedBuilder и задаем функции перемещения шара, магического Шара Карл!
<p align="center"><img width="474" alt="Снимок экрана 2023-07-26 в 10 06 10" src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/8ec95778-cca5-47b8-876f-880ca155526e"></p>
Возможно было излишним создавать отдельный провайдер для котроллера анимаций, но изначальная идея была в том чтобы не использовать StatefullConsumerWidget (у риверпода немного свои виджеты, выпендриваются :)), но т.к. в любом случае требуется добавления миксина SingleTickerProviderStateMixin, так сделать не получилось, но на тот момент провайдер уже остался, ну и ладно, он не мешает. Продолжим!

### Управление состоянием

Рассмотрим AsyncNotifierProvider управляющий состоянием. После проверки на использование репозитория, меняется состояние на загрузочное, а затем используя конструкцию .guard, которая по сути просто заменяет блок try/catch, делаем необходимый запрос, при различных ответах состояния будут отличатся и наш watcher в виджете изменится.
<p align="center"><img width="571" alt="Снимок экрана 2023-07-26 в 09 58 07" src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/46365027-0b6d-403f-92ff-e3de5278f62c"></p>

### Трясем телефон и слушаем :)

Для отслеживания тряски телефона используем предложенную библиотеку Shake, она предоставляет нам возможность создания слушателя, ожидающего самого действа и выполяющего некий код внутри. Было решено поместить реализацию в отельный сервис, который будет инициализироваться ДО функции RunApp, для этого создаем сам сервис с необходимыми функциями, создаем Provider состояние которого будет содержать данный класс:
<p align="center"><img width="629" alt="Снимок экрана 2023-07-26 в 10 00 35" src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/cf95bc5e-38cc-4bd7-9e3d-8acd7f997447"></p>
После чего, необходимо перейти в функцию main и при помощи UncontrolledProviderScope передать контейнер с заранее инициализированным провайдером (не забываем про проверки на платформу, экран с браузером никто не трясет хд)
<p align="center"><img width="486" alt="Снимок экрана 2023-07-26 в 09 59 36" src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/35bb5f8f-417b-495e-9e0e-efe575d9e453"></p>

### Виброотклик

Кажется странным, когда телефон трясется, а на нём просто перерисовывается экран, вибрация добавляет "острых" ощущений. Для её добавления, используем пакет flutter_vibrate и при выполнении функции получения данных в провайдере, запускаем виброотклик, также проверяя на платформу (шутки с браузером здесь не уместны, всё серьезно :) )
<p align="center"><img width="365" alt="Снимок экрана 2023-07-26 в 10 01 25" src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/c2bbb684-9cd2-406a-bf69-c29e80dd578a"></p>

### Смена темы

Изначально все создавалось на белой теме, но под конец дня это ужасно резало глаз, поэтому с помощью нехитрых махинаций создаем изменение темы (иии тема превращается в элллегантную тёмную). Создаем переменные для каждой темы и провайдер для хранения состояния:
<p align="center"><img width="551" alt="Снимок экрана 2023-07-26 в 10 03 04" src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/98c84ef3-ec95-42d2-8968-531e498e5605"></p>
В классе MyApp "смотрим" за провайдером с темой:
<p align="center"><img width="595" alt="Снимок экрана 2023-07-26 в 10 03 23" src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/e70f4089-3c7a-4a53-89e9-7d32c4749822"></p>
А на главном экране создаем кнопочку для изменения темы:
<p align="center"><img width="567" alt="Снимок экрана 2023-07-26 в 10 04 03" src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/34dcecd2-66fa-49b9-8ab6-27bb1e6469bb"></p>
Конечный результат представлен на скриншотах, спасибо если дочитали до конца, я старался) Получился больше какой то гайд по приложению нежели презентация, прошу простить за много букаф и за токсичную тему на скринах, если вдруг кому то не зашло. В любом случае спасибо за организацию такого мероприятия, т.к. впервые в таком учавствовал словил много положительных эмоций, еще не приходилось работать в таком быстром темпе. В общем, спасибо еще раз!))))

# Темная тема
<p float="left">
  <img src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/a35a660d-43b7-4438-9baf-c2f12b8044d6" width="250">
  <img src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/2cd66051-bd3d-40a7-a5bb-cefcff72bbb3" width="250">
  <img src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/a32d1725-6870-4594-8cb5-65949e0bf541" width="250">
  <img src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/38508505-c51d-4f05-b1aa-c8db5d7ab530" width="250">
</p>

# Светлая тема
<p>
  <img src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/e21cb1eb-9387-40a8-8ae3-c9c5df0e2ea9" width="250">
  <img src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/0a01e31c-5468-41ed-9294-793d8d4db41f" width="250">
  <img src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/dc0e121d-532c-49c7-af40-6aec5df4ac4c" width="250">
  <img src="https://github.com/SadMilk408/surf-flutter-study-jam-4/assets/72536608/2354219b-11f4-4dab-b81d-75dc0cd511a8" width="250">
</p>
